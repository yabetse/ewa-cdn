function disablePhonenumberInputClickEvents(){$("button#request_otp").prop("disabled",!0),$("input#phone_number").prop("disabled",!0),$("#phoneNumberInput .btn-switch-login").css("pointer-events","none")}function enablePhonenubmerInputClickEvents(){$("button#request_otp").prop("disabled",!1),$("input#phone_number").prop("disabled",!1),$("#phoneNumberInput .btn-switch-login").css("pointer-events","")}function disableOTPEntryClickEvents(){$("button#validate_otp").prop("disabled",!0),$("input#otp_code").prop("disabled",!0),$("#validate-otp-form .login-selection").css("pointer-events","none"),$(".btn-otp-back").css("pointer-events","none")}function enableOTPEntryClickEvents(){$("button#validate_otp").prop("disabled",!1),$("input#otp_code").prop("disabled",!1),$("#validate-otp-form .login-selection").css("pointer-events",""),$(".btn-otp-back").css("pointer-events","")}function showOTPEntryView(){$(".view-group-2").hide(),$(".view_45 .form-cont").removeClass("hidden-block"),$(".otp-back-cont").removeClass("hidden"),$("#login-graphic-2").addClass("img-hidden"),$("#login-graphic-3").removeClass("img-hidden")}function sendOTP(callback){$("#kn-loading-spinner").show();let phoneNr="66".concat($("#phone_number").val());$("#otpNumber").text("+".concat(phoneNr)),$.ajax({url:"https://ewaservices.ddns.net/ewa/send_sms.php?to="+phoneNr}).done((function(response){$("#kn-loading-spinner").hide(),callback&&callback()}))}function submitOTP(){let OTPCode=$("input#otp_code").val(),phoneNr=$("input#phone_number").val();$("#kn-loading-spinner").show(),disableOTPEntryClickEvents(),$.ajax({url:"https://ewaservices.ddns.net/ewa/validate_otp.php?to="+phoneNr+"&otp="+OTPCode}).done((function(response){var obj=$.parseJSON(response);$("#kn-loading-spinner").hide(),enableOTPEntryClickEvents(),obj.success?($("input#email").val(obj.email),$("input#password").val(obj.password),$("form.login_form").submit()):alert(obj.details)}))}function showOTPSentAlert(){$('\n        <div class="alert-otp-resent">\n            <span class="material-icons">\n                chat_bubble\n            </span>\n\n            OTP has been sent\n        </div>\n    ').insertBefore("#validateOTP .view-header"),setTimeout((function(){$(".alert-otp-resent").remove()}),5e3)}$.validator.addMethod("thaiPhone",(function(value,element){return value=value.replace(/\s+/g,""),this.optional(element)||9==value.length&&value.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/)}),"Please enter a valid phone number"),$("#otp-input-form").validate({rules:{phone_number:{required:!0,thaiPhone:!0}},messages:{phone_number:"Please enter a valid phone number"},errorPlacement:function(error,element){error.insertAfter(element.parent())},submitHandler:function(_,event){event.preventDefault(),disablePhonenumberInputClickEvents(),sendOTP(()=>{enablePhonenubmerInputClickEvents(),showOTPEntryView()})}}),$("#validate-otp-form").validate({rules:{otp_code:{required:!0,minlength:4,maxlength:4}},messages:{otp_code:{required:"Please enter a valid OTP code",minlength:"OTP code must be 4 characters",maxlength:"OTP code must be 4 characters"}},errorPlacement:function(error,element){error.insertAfter(element.parent())},submitHandler:function(form,event){event.preventDefault(),submitOTP()}}),$("#validate-otp-form .login-selection").click(()=>{disableOTPEntryClickEvents(),sendOTP(()=>{showOTPSentAlert(),enableOTPEntryClickEvents()})});