function hide_error(){$(".error-message-custom").hide()}function calculate_withdrawable(e,t,a){var l=new Date;return(e*(l.getDate()-1)/new Date(l.getFullYear(),l.getMonth()+1,0).getDate()-t)*a}function display_message(e){if(0==e.status){var t=e.error;$(".error-message-custom").hide(),$(".validation-message-custom").hide(),$("<div class='error-message-custom'><strong>"+t+"</strong></div>").insertBefore($("#view_133 form > ul"))}1==e.status?($(".error-message-custom").hide(),$(".validation-message-custom").hide(),$("<div class='validation-message-custom'><strong>All inputs are correct</strong></div>").insertBefore($("#view_133 form > ul")),$("#view_133 #submit-cutoff-btn").prop("disabled",!1)):$("#view_133 #submit-cutoff-btn").prop("disabled",!0)}amount_requested_checks=function(e,t,a,l,i,o,n,s,_){var d=[a,i,o,.1*e],r=Math.min.apply(null,d.filter(Boolean));if(r<l)var f=!1;else f=!0;var m=_>0&&_>=l&&_<=r,c=t>=120;return 0==(s<=0||n<s)?{status:!1,error:"You have exceeded the maximum number of requests allowed per month"}:0==f?{status:!1,error:"The remaining balance ("+(Math.round(100*r)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+") is lower than the minimum withdrawal amount allowed ("+(Math.round(100*l)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+")"}:0==m&&i>0?{status:!1,error:"Please provide an amount between "+(Math.round(100*l)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" and "+(Math.round(100*r)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}:0==m?{status:!1,error:"Please provide an amount greater than "+(Math.round(100*l)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}:0==c?{status:!1,error:"You are employed since "+t+" days. You need to fulfill 120 days to be eligible to submit requests after cutiff days"}:{status:!0}};var buttons_html="<div class=\"buttons-wrapper\">\n                        <button id='next-cutoff-btn' onclick='proceed_to_form()'>Proceed</button>\n                        <button id='back-cutoff-btn' onclick='back_from_form()'>Back</button>\n                        <button id='submit-cutoff-btn' onclick='submit_cutoff_form()'>Submit</button>\n                    </div>";function proceed_to_form(){$("#view_133 #kn-input-field_18").css({visibility:"unset",position:"unset"}),$("#view_133 #kn-input-field_59").css({visibility:"unset",position:"unset"}),$("#view_133 #kn-input-field_92").css({visibility:"unset",position:"unset"}),$("#view_133 #kn-input-field_80").css({visibility:"unset",position:"unset"}),$("#view_133 form .kn-section-break").css({visibility:"hidden",position:"absolute"}),$("#view_133 #kn-input-field_119").css({visibility:"hidden",position:"absolute"}),$("#view_133 .buttons-wrapper #next-cutoff-btn").css({display:"none"}),$("#view_133 .buttons-wrapper #back-cutoff-btn").css({display:"unset"}),$("#view_133 .buttons-wrapper #submit-cutoff-btn").css({display:"unset"})}function back_from_form(){$("#view_133 #kn-input-field_18").css({visibility:"hidden",position:"absolute"}),$("#view_133 #kn-input-field_59").css({visibility:"hidden",position:"absolute"}),$("#view_133 #kn-input-field_92").css({visibility:"hidden",position:"absolute"}),$("#view_133 #kn-input-field_80").css({visibility:"hidden",position:"absolute"}),$("#view_133 form .kn-section-break").css({visibility:"unset",position:"unset"}),$("#view_133 #kn-input-field_119").css({visibility:"unset",position:"unset"}),$("#view_133 .buttons-wrapper #next-cutoff-btn").css({display:"unset"}),$("#view_133 .buttons-wrapper #back-cutoff-btn").css({display:"none"}),$("#view_133 .buttons-wrapper #submit-cutoff-btn").css({display:"none"})}function submit_cutoff_form(){$("#view_133 .kn-submit button").click()}$(buttons_html).insertAfter("#view_133 #kn-input-field_80"),$(".view_133 form #field_18").attr("placeholder","Amount"),$(".view_133 form #field_80").attr("placeholder","Withdrawal Remark");var currency=$("#view_64 .field_122 .kn-detail-body").text(),normal_fee_setting=parseFloat(""==$("#view_64 .field_93 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_64 .field_93 .kn-detail-body").text().replace(/,/g,"")),fast_fee_setting=parseFloat(""==$("#view_64 .field_94 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_64 .field_94 .kn-detail-body").text().replace(/,/g,"")),cutoff_fee_setting=parseFloat(""==$("#view_64 .field_120 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_64 .field_120 .kn-detail-body").text().replace(/,/g,"")),normal_withdrawal_speed=$("#view_64 .field_96 .kn-detail-body").text(),fast_withdrawal_speed=$("#view_64 .field_97 .kn-detail-body").text(),cutoff_withdrawal_speed=$("#view_64 .field_121 .kn-detail-body").text();if(0==normal_fee_setting)var normal_fee_message="There is no service fee";else normal_fee_message="There is a fee of "+normal_fee_setting+" "+currency+" per disbursement";if(0==fast_fee_setting)var fast_fee_message="There is no service fee";else fast_fee_message="There is a fee of "+fast_fee_setting+" "+currency+" per disbursement";if(0==cutoff_fee_setting)var cutoff_fee_message="There is no service fee";else cutoff_fee_message="There is a fee of "+cutoff_fee_setting+" "+currency+" per disbursement";$(".view_133 form .kn-input .kn-radio .control").each(function(){let e=$(this).find(".option.radio div"),t=$(e).text().trim().split("-");if($(e).text().toLowerCase().indexOf("normal")>-1)var a=normal_fee_message,l=normal_withdrawal_speed,i="normal";else if($(e).text().toLowerCase().indexOf("fast")>-1)a=fast_fee_message,l=fast_withdrawal_speed,i="fast";else{$(this).addClass("selected"),$(this).find("input").prop("checked",!0);a=cutoff_fee_message,l=cutoff_withdrawal_speed,i="cutoff"}let o=`\n      <div class='${i}'>\n          <span class='widthdrawl-radio'>\n              <span class='wr-title'>${t[0]}</span>\n              <span class='wr-desc'>${t[1].replace("{withdrawal_fee}",a).replace("{withdrawal_speed}",l)}</span>\n          </span>\n      </div>\n  `;$(e).html(o)}),$(document).on("knack-form-submit.view_133",function(e,t,a){$(".error-message-custom").hide(),$(".validation-message-custom").hide()}),$("#view_133 #submit-cutoff-btn").prop("disabled",!0);var requested_transactions=parseInt(""==$("#view_66 .kn-pivot-calc:eq(1)").text().replace(/,/g,"")?0:$("#view_66 .kn-pivot-calc:eq(1)").text().replace(/,/g,"")),max_number_requests=parseFloat(""==$("#view_64 .field_91 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_64 .field_91 .kn-detail-body").text().replace(/,/g,"")),input_val=0,current_month=(new Date).getFullYear()+"-"+((new Date).getMonth()+1),next_month=11==(new Date).getMonth()?(new Date).getFullYear()+1+"-01":(new Date).getFullYear()+"-"+((new Date).getMonth()+2),cutoff_day="-",months=$("#view_97 .kn-table tbody td.field_88 span"),cutoffs=$("#view_97 .kn-table tbody td.field_82 span"),paydays=$("#view_97 .kn-table tbody td.field_76 span");$.each(months,function(e,t){t.textContent.trim()==current_month?(cutoff_day=cutoffs[e].textContent.trim(),payday=paydays[e].textContent.trim()):t.textContent.trim()==next_month&&(next_payday=paydays[e].textContent.trim())});cutoff_day=""==cutoff_day?"-":cutoff_day;var payday=""==payday?"-":payday,next_payday=""==next_payday?"-":next_payday;$("#view_133 form .kn-input.kn-input-section_break.control").replaceWith($("#view_133 form .kn-input.kn-input-section_break.control").html().replace("{payday_current}",payday).replace("{payday_next}",next_payday));var base_salary=parseFloat(""==$("#view_65 .field_44 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_65 .field_44 .kn-detail-body").text().replace(/,/g,"")),requested_amount=parseFloat(""==$("#view_66 .kn-pivot-calc:eq(0)").text().replace(/,/g,"")?0:$("#view_66 .kn-pivot-calc:eq(0)").text().replace(/,/g,"")),withdrawable_threshold=parseFloat(""==$("#view_64 .field_89 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_64 .field_89 .kn-detail-body").text().replace(/,/g,"")),min_allowed_employee=parseFloat(""==$("#view_65 .field_52 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_65 .field_52 .kn-detail-body").text().replace(/,/g,"")),max_allowed_employee=parseFloat(""==$("#view_65 .field_53 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_65 .field_53 .kn-detail-body").text().replace(/,/g,"")),max_cutoff_allowed_employee=parseFloat(""==$("#view_65 .field_123 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_65 .field_123 .kn-detail-body").text().replace(/,/g,"")),min_allowed_company=parseFloat(""==$("#view_64 .field_87 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_64 .field_87 .kn-detail-body").text().replace(/,/g,"")),max_allowed_company=parseFloat(""==$("#view_64 .field_90 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_64 .field_90 .kn-detail-body").text().replace(/,/g,"")),max_cutoff_allowed_company=parseFloat(""==$("#view_64 .field_124 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_64 .field_124 .kn-detail-body").text().replace(/,/g,"")),employment_start_txt=$("#view_65 .field_78 .kn-detail-body").text().trim(),employment_start=new Date(employment_start_txt.split("/")[2],employment_start_txt.split("/")[1]-1,employment_start_txt.split("/")[0]),today=new Date,employed_since_days=Math.ceil((today-employment_start)/864e5);if(min_allowed_employee>0&&min_allowed_company>0)var min_allowed=Math.max(min_allowed_employee,min_allowed_company);else if(min_allowed_employee>0)min_allowed=min_allowed_employee;else if(min_allowed_company>0)min_allowed=min_allowed_company;else min_allowed=0;if(max_allowed_employee>0&&max_allowed_company>0)var max_allowed=Math.min(max_allowed_employee,max_allowed_company);else if(max_allowed_employee>0)max_allowed=max_allowed_employee;else if(max_allowed_company>0)max_allowed=max_allowed_company;else max_allowed=0;if(max_cutoff_allowed_employee>0&&max_cutoff_allowed_company>0)var max_cutoff_allowed=Math.min(max_cutoff_allowed_employee,max_cutoff_allowed_company);else if(max_cutoff_allowed_employee>0)max_cutoff_allowed=max_cutoff_allowed_employee;else if(max_cutoff_allowed_company>0)max_cutoff_allowed=max_cutoff_allowed_company;else max_cutoff_allowed=0;var speed=$('input[name="view_133-field_92"]:checked').val();if(speed.toLowerCase().indexOf("normal")>-1)var withdrawal_fee=normal_fee_setting;else if(speed.toLowerCase().indexOf("fast")>-1)withdrawal_fee=fast_fee_setting;else if(speed.toLowerCase().indexOf("cutoff")>-1)withdrawal_fee=cutoff_fee_setting;$("#view_133 #field_63").attr("value",withdrawal_fee);var available_amount=calculate_withdrawable(base_salary,requested_amount,withdrawable_threshold),arr=[available_amount,max_allowed,max_cutoff_allowed,.1*base_salary];console.log("available amount:"),console.log(available_amount),console.log("max allowed before cutoff:"),console.log(max_allowed),console.log("max allowed after cutoff:"),console.log(max_cutoff_allowed),console.log("10% of salary:"),console.log(.1*base_salary);var max_allowed_bis=Math.min.apply(null,arr.filter(Boolean));if(max_allowed>0)if(max_allowed_bis>=min_allowed)var request_amount='<span class="amount-info-message">Amount should be between <span>'+(Math.round(100*min_allowed)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"</span> and <span>"+(Math.round(100*max_allowed_bis)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"</span></span>";else request_amount='<span class="amount-info-message">The remaining balance (<span>'+(Math.round(100*max_allowed_bis)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"</span>) is lower than the minimum withdrawal amount allowed (<span>"+(Math.round(100*min_allowed)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"</span>)</span>";else request_amount='<span class="amount-info-message">Amount should be greater than <span>'+(Math.round(100*min_allowed)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"</span></span>";$(request_amount).insertAfter("#kn-input-field_18 label"),$("input[type=radio][name=view_133-field_92]").change(function(){var e=$("#field_18").val(),t=$('input[name="view_133-field_92"]:checked').val();t.toLowerCase().indexOf("normal")>-1?withdrawal_fee=normal_fee_setting:t.toLowerCase().indexOf("fast")>-1?withdrawal_fee=fast_fee_setting:t.toLowerCase().indexOf("cutoff")>-1&&(withdrawal_fee=cutoff_fee_setting),$("#view_133 #field_63").attr("value",withdrawal_fee),available_amount=calculate_withdrawable(base_salary,requested_amount,withdrawable_threshold),display_message(amount_requested_checks(base_salary,employed_since_days,available_amount,min_allowed,max_allowed,max_cutoff_allowed,requested_transactions,max_number_requests,e))}),$("input#field_18").on("input",function(e){var t=$(this).val(),a=$('input[name="view_133-field_92"]:checked').val();a.toLowerCase().indexOf("normal")>-1?withdrawal_fee=normal_fee_setting:a.toLowerCase().indexOf("fast")>-1?withdrawal_fee=fast_fee_setting:a.toLowerCase().indexOf("cutoff")>-1&&(withdrawal_fee=cutoff_fee_setting),available_amount=calculate_withdrawable(base_salary,requested_amount,withdrawable_threshold),display_message(amount_requested_checks(base_salary,employed_since_days,available_amount,min_allowed,max_allowed,max_cutoff_allowed,requested_transactions,max_number_requests,t))});